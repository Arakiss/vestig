export const metadata = {
  title: 'API Reference',
  description: 'Complete API documentation for Vestig logging library. Methods, options, types, and configuration reference.',
}

# API Reference

Complete API documentation for Vestig.

## createLogger

Creates a new logger instance with custom configuration.

```typescript
import { createLogger } from 'vestig'

const logger = createLogger(config?: LoggerConfig)
```

### LoggerConfig

<Table><TableHead><TableRow><TableHeader>Option</TableHeader><TableHeader>Type</TableHeader><TableHeader>Default</TableHeader><TableHeader>Description</TableHeader></TableRow></TableHead><TableBody><TableRow><TableCell>`level`</TableCell><TableCell>`LogLevel`</TableCell><TableCell>`'info'`</TableCell><TableCell>Minimum log level</TableCell></TableRow><TableRow><TableCell>`enabled`</TableCell><TableCell>`boolean`</TableCell><TableCell>`true`</TableCell><TableCell>Enable/disable logging</TableCell></TableRow><TableRow><TableCell>`structured`</TableCell><TableCell>`boolean`</TableCell><TableCell>`false` (dev) / `true` (prod)</TableCell><TableCell>JSON output</TableCell></TableRow><TableRow><TableCell>`sanitize`</TableCell><TableCell>`boolean`</TableCell><TableCell>`true`</TableCell><TableCell>Enable PII sanitization</TableCell></TableRow><TableRow><TableCell>`sanitizeFields`</TableCell><TableCell>`string[]`</TableCell><TableCell>`[]`</TableCell><TableCell>Additional fields to redact</TableCell></TableRow><TableRow><TableCell>`context`</TableCell><TableCell>`Record<string, unknown>`</TableCell><TableCell>`{}`</TableCell><TableCell>Static context</TableCell></TableRow><TableRow><TableCell>`namespace`</TableCell><TableCell>`string`</TableCell><TableCell>`''`</TableCell><TableCell>Logger namespace</TableCell></TableRow></TableBody></Table>

### Example

```typescript
const logger = createLogger({
  level: 'debug',
  structured: true,
  sanitize: true,
  sanitizeFields: ['customSecret'],
  context: {
    service: 'api',
    version: '1.0.0'
  },
  namespace: 'my-app'
})
```

## Default Logger

A pre-configured logger instance for quick usage.

```typescript
import { log } from 'vestig'

log.trace(message, ...args)
log.debug(message, ...args)
log.info(message, ...args)
log.warn(message, ...args)
log.error(message, ...args)
```

### Methods

<Table><TableHead><TableRow><TableHeader>Method</TableHeader><TableHeader>Description</TableHeader></TableRow></TableHead><TableBody><TableRow><TableCell>`trace(message, ...args)`</TableCell><TableCell>Log at trace level</TableCell></TableRow><TableRow><TableCell>`debug(message, ...args)`</TableCell><TableCell>Log at debug level</TableCell></TableRow><TableRow><TableCell>`info(message, ...args)`</TableCell><TableCell>Log at info level</TableCell></TableRow><TableRow><TableCell>`warn(message, ...args)`</TableCell><TableCell>Log at warn level</TableCell></TableRow><TableRow><TableCell>`error(message, ...args)`</TableCell><TableCell>Log at error level</TableCell></TableRow><TableRow><TableCell>`setLevel(level)`</TableCell><TableCell>Change minimum level</TableCell></TableRow><TableRow><TableCell>`getLevel()`</TableCell><TableCell>Get current level</TableCell></TableRow><TableRow><TableCell>`enable()`</TableCell><TableCell>Enable logging</TableCell></TableRow><TableRow><TableCell>`disable()`</TableCell><TableCell>Disable logging</TableCell></TableRow><TableRow><TableCell>`isEnabled()`</TableCell><TableCell>Check if enabled</TableCell></TableRow><TableRow><TableCell>`child(namespace, config?)`</TableCell><TableCell>Create child logger</TableCell></TableRow><TableRow><TableCell>`flush()`</TableCell><TableCell>Flush pending logs</TableCell></TableRow></TableBody></Table>

## Context Functions

### withContext

Runs a function with logging context.

```typescript
import { withContext } from 'vestig'

const result = withContext(context, callback)
```

### withContextAsync

Async version of withContext.

```typescript
import { withContextAsync } from 'vestig'

const result = await withContextAsync(context, asyncCallback)
```

### getContext

Gets the current context.

```typescript
import { getContext } from 'vestig'

const ctx = getContext()
// → { requestId: '...', traceId: '...' } | undefined
```

### createCorrelationContext

Creates a new correlation context with IDs.

```typescript
import { createCorrelationContext } from 'vestig'

const ctx = createCorrelationContext(existing?)
// → { requestId, traceId, spanId, ...existing }
```

## ID Generators

### generateRequestId

Generates a UUID v4 request ID.

```typescript
import { generateRequestId } from 'vestig'

const id = generateRequestId()
// → '550e8400-e29b-41d4-a716-446655440000'
```

### generateTraceId

Generates a 32-character hex trace ID (W3C Trace Context).

```typescript
import { generateTraceId } from 'vestig'

const id = generateTraceId()
// → '0af7651916cd43dd8448eb211c80319c'
```

### generateSpanId

Generates a 16-character hex span ID.

```typescript
import { generateSpanId } from 'vestig'

const id = generateSpanId()
// → 'b7ad6b7169203331'
```

## Sanitization

### sanitize

Sanitizes an object, redacting sensitive fields.

```typescript
import { sanitize } from 'vestig'

const safe = sanitize(data, additionalFields?)
```

### createSanitizer

Creates a sanitizer with custom fields.

```typescript
import { createSanitizer } from 'vestig'

const mySanitize = createSanitizer(['customField'])
const safe = mySanitize(data)
```

## Utilities

### serializeError

Converts an Error to a serializable object.

```typescript
import { serializeError } from 'vestig'

const obj = serializeError(error)
// → { name, message, stack, cause? }
```

### isError

Type guard for Error objects.

```typescript
import { isError } from 'vestig'

if (isError(value)) {
  // value is Error
}
```

### getErrorMessage

Extracts error message from unknown value.

```typescript
import { getErrorMessage } from 'vestig'

const msg = getErrorMessage(error)
```

## Constants

### LOG_LEVELS

Map of log levels to numeric values.

```typescript
import { LOG_LEVELS } from 'vestig'

// { trace: 10, debug: 20, info: 30, warn: 40, error: 50 }
```

### RUNTIME

Current runtime identifier.

```typescript
import { RUNTIME } from 'vestig'

// 'node' | 'bun' | 'deno' | 'edge' | 'browser' | 'unknown'
```

### CAPABILITIES

Runtime capability flags.

```typescript
import { CAPABILITIES } from 'vestig'

// { hasAsyncLocalStorage, hasConsole, hasProcess, ... }
```

### ENV_VARS

Environment variable names.

```typescript
import { ENV_VARS } from 'vestig'

// { LEVEL, ENABLED, STRUCTURED, SANITIZE }
```

## Types

```typescript
import type {
  LogLevel,      // 'trace' | 'debug' | 'info' | 'warn' | 'error'
  LoggerConfig,  // Configuration options
  Logger,        // Logger interface
  LogEntry,      // Structured log entry
  Context,       // Context type
} from 'vestig'
```
